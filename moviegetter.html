<!DOCTYPE html>
<html lang="en">

  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <title>Moviegetter</title>


    <!--- jQuery  -------------------------------------------------->

    <script src="https://code.jquery.com/jquery-3.1.1.min.js" integrity="sha256-hVVnYaiADRTO2PzUGmuLJr8BLUSjGIZsDYGmIJLv2b8=" crossorigin="anonymous">
    </script>

    <div=< !-- Local css -->
      <link href="assets/css/reset.css" rel="stylesheet" type="text/css">
      <link href="assets/css/style.css" rel="stylesheet" type="text/css">

  </head>

  <body>

    <div id="theResults"></div>


    <JavaScript Link and Code ------------------------------------------>
      <script src="https://www.gstatic.com/firebasejs/3.7.4/firebase.js"></script>
      <script>
      $(document).ready(function() {
            var theMovies = [];
            //loops through the genres and gets 40 movies, waits 15 seconds and gets the next one.  It prints them out in csv format on this page in a div above.


            // function getMoviesFromID (theGenreID){
            //   console.log(theGenreID)
            //   console.log(typeof theGenreID)
            // }

            function getMoviesfromArrayIDs(genreids) {
              var pageArray = [];
              // turn genreids values into an array]
                $.each(genreids, function(i) {
                  setTimeout(function() {
                    console.log(typeof genreids[i])
                    console.log(genreids[i])
                    var settings = {
                      "async": true,
                      "crossDomain": true,
                      "url": "https://api.themoviedb.org/3/genre/ " + genreids[i] + "+/movies?sort_by=created_at.asc&include_adult=false&language=en-US&api_key=9e47aea3d7ab855ced2fcc031863b928",
                      "method": "GET",
                      "headers": {},
                      "data": "{}"
                    }
                    $.ajax(settings).done(function(response) {
                      var theResults = response.results
                      //console.log(JSON.stringify(theResults));
                      $.each(theResults,function(k){
                      console.log(JSON.stringify(theResults[k].original_title))
                      var theMovie = [theResults[k].original_title, theResults[k].overview, ]
                      //     theMovie.push(k.)
                      //   theMovies.
                      //
                    })




                      theMovies.push(JSON.stringify(response));
                      console.log()
                      console.log(JSON.stringify(response))
                      console.log(theMovies)
                    })
                    }, i * 3000);
              $("#theResults").text(theMovies)
            })
          }

              // function GetObjectMoviesUsingGenres(){
              //   var theGenre = thegenres.genres;
              //     for(var i = 0; i < theGenre.length; i++ ){
              //       theGenreGet(theGenre);
              //       console.log("theGenre.length +")
              //       console.log("I +++++++++++++++++++++++++++++");
              //       }
              //     }

              // gets the genres in JSON and parse out the Genre ids
              function getObjectGenresIdsWithAjax() {
                var settings = {
                  "async": true,
                  "crossDomain": true,
                  "url": "https://api.themoviedb.org/3/genre/movie/list?language=en-US&api_key=9e47aea3d7ab855ced2fcc031863b928",
                  "method": "GET",
                  "headers": {},
                  "data": "{}"
                }
                $.ajax(settings).done(function(response) {
                  var genreObjectArray = response.genres;
                  console.log(JSON.stringify(genreObjectArray));
                  console.log(typeof genreObjectArray)
                  var theArrayGenreIds = [];
                  for (var i = 0; i < genreObjectArray.length; i++) {
                    theArrayGenreIds.push(genreObjectArray[i]["id"]); // I should now have the genre Ids alone in an array.
                  }

                  getMoviesfromArrayIDs(theArrayGenreIds)
                })
              }
              getObjectGenresIdsWithAjax();
            })
      </script>

  </body>

</html>
